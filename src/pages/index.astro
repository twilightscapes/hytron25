---
import PageLayout from "@/layouts/Base.astro";
import DynamicPageRenderer from "@/components/DynamicPageRenderer.astro";
import { getEntry } from 'astro:content';
// import Features from "@/components/features.astro"
// import Video from "@/components/ChannelSubscribeButton.astro"
// Get the existing "home" page data (your template-based homepage)
// This reads from your existing home.mdoc page configuration
let homePage;
try {
  homePage = await getEntry('pages', 'home');
} catch (e) {
  console.warn('Could not load home page configuration:', e);
}

// Use template-based home page configuration
let sections = [];
let pwaSettings, siteSettings;

if (homePage && homePage.data.useTemplateSystem && homePage.data.sections) {
  // Use the template-based home page configuration
  sections = homePage.data.sections;
} else {
  console.warn('Home page template system not configured');
  sections = [];
}

// Load settings for metadata
pwaSettings = await getEntry('pwaSettings', 'index');
siteSettings = await getEntry('siteSettings', 'main');

const meta = {
  title: pwaSettings?.data?.title || 'Home',
  description: pwaSettings?.data?.description || 'Welcome to our site',
};
---

<PageLayout meta={meta} themeMode={siteSettings?.data?.themeMode ?? 'user'}>
  <!-- Template system rendering - clean and simple -->
   <div class="home">
  <DynamicPageRenderer 
    sections={sections}
    pageContent=""
  />
</div>
          <!-- <Video /> -->
<!-- <Features /> -->
</PageLayout>
